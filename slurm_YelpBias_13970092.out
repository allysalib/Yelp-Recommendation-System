                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
97603
                  user_id             business_id  review_stars  \
0  r98FaAOAoJDCPp384XpcYA  -7H-oXvCxJzuT42ky6Db0g             3   
1  B3_aw0o0ncQfRgPNMEVBtA  -Dnh48f029YNugtMKkkI-Q             2   
2  9fek8sBMCATlL4k0YwtFdg  -YR7K3rw6VAQ1-MjslvsoQ             5   
3  F1d0aQcDvhwn9EfXC6vgMw  -ZBfr1BHvArFp1d6XH8jOQ             5   
4  dOGCIC__6E_Mvra8JxnYOw  -av1lZI1JDY_RZN2eTMnWg             4   

                 date  
0 2013-09-28 14:33:17  
1 2016-07-27 04:50:28  
2 2017-10-22 20:42:50  
3 2014-03-07 18:23:30  
4 2014-03-29 05:03:39  
Traceback (most recent call last):
  File "./Bias_and_BiasMF_Models.py", line 324, in <module>
    main()
  File "./Bias_and_BiasMF_Models.py", line 124, in main
    results_10recs = rla.compute(recs_10, val_binary)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/topn.py", line 176, in compute
    res = job.compute(self.n_jobs)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/topn.py", line 67, in compute
    res = pd.concat(res, ignore_index=True)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/pandas/core/reshape/concat.py", line 274, in concat
    op = _Concatenator(
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/pandas/core/reshape/concat.py", line 328, in __init__
    objs = list(objs)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/topn.py", line 37, in _rla_worker
    return model._compute_group(col, val)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/topn.py", line 75, in _compute_group
    return pd.DataFrame.from_records(gen, columns=self.rec_key + mnames)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/pandas/core/frame.py", line 1762, in from_records
    values += data
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/topn.py", line 87, in _iter_measurements
    results = tuple(mf(gdf, g_truth, **margs) for (mf, mn, margs) in self.metrics)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/topn.py", line 87, in <genexpr>
    results = tuple(mf(gdf, g_truth, **margs) for (mf, mn, margs) in self.metrics)
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/lenskit/metrics/topn.py", line 98, in ndcg
    tpos = truth.index.get_indexer(recs['item'])
  File "/home/as12453/miniconda3/envs/dsga3001/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 2980, in get_indexer
    raise InvalidIndexError(
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
